# scRNAseq-monocytes-MI-CCD

This repository contains the analysis code and workflows used to characterize human monocyte subsets in myocardial infarction (MI) and chronic coronary disease (CCD) patients using single-cell RNA sequencing (scRNA-seq). The analysis combines Galaxy-based preprocessing with downstream processing in R, and was developed as part of my doctoral research at the University of Freiburg.

## ğŸ”¬ Overview of Analysis Workflow

The scRNA-seq data processing and analysis were conducted in two main phases:

### 1. **Low-level preprocessing**
- Raw BCL files were demultiplexed into FASTQ using **Cell Ranger mkfastq** and **bcl2fastq**.
- Gene-barcode matrices were generated using **Cell Ranger count**.
- Initial quality control and preprocessing were performed on [Galaxy Europe](https://usegalaxy.eu):
  - Filtering of cells with high mitochondrial content or abnormal gene counts.
  - Merging of samples using **AnnData** tools.
  - Normalization based on the [Galaxy Scanpy tutorial](https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-scanpy-pbmc3k/tutorial.html).

### 2. **Downstream analysis in R**
- AnnData files were converted to Seurat objects using **sceasy** and **reticulate**.
- Processed using **Seurat v5.0.3**, **SCTransform**, **UMAP**, **Louvain clustering**, and **CCA** for batch correction.
- Cell type annotation was done based on canonical markers.
- **Pseudobulk analysis** was carried out by:
  - Re-uploading the AnnData object to Galaxy.
  - Creating pseudobulk count matrices using **Decoupler**.
  - Running **edgeR** for differential gene expression (DEGs).
  - Performing GO/KEGG enrichment with **GOseq**, correcting for gene length bias.

## ğŸ”„ Galaxy Workflows Used

The following Galaxy workflows were used as part of this analysis:

- **Pseudobulk differential expression analysis (Decoupler + edgeR)**  
  [Galaxy IWC: pseudobulk workflow](https://github.com/galaxyproject/iwc/tree/main/workflows/scRNAseq/pseudobulk-worflow-decoupler-edger)  
  *Developed by Diana Chiang Jurado (ORCID: 0000-0002-5857-1477), Pavankumar Videm (ORCID: 0000-0002-5192-126X), and Pablo Moreno (ORCID: 0000-0002-9856-1679).*

- **GOseq enrichment analysis**  
  [Galaxy IWC: goseq workflow](https://github.com/galaxyproject/iwc/tree/main/workflows/transcriptomics/goseq)  
  *Developed by Amirhossein Naghsh Nilchi.*

## ğŸ“ Repository Structure

```
scRNAseq-monocytes-MI-CCD/
â”‚
â”œâ”€â”€ scripts/                  # Modular R scripts (cleaned, numbered)
â”‚   â”œâ”€â”€ 01_load_and_prepare.R
â”‚   â”œâ”€â”€ 02_qc_filtering.R
â”‚   â”œâ”€â”€ 03_integration_harmony.R
â”‚   â”œâ”€â”€ 04_integration_cca.R
â”‚   â”œâ”€â”€ 05_integration_scvi.R
â”‚   â”œâ”€â”€ 06_annotation.R
â”‚   â”œâ”€â”€ 07_dimensionality_reduction.R
â”‚   â”œâ”€â”€ 08_dotplots_markers.R
â”‚   â”œâ”€â”€ 09_GO_KEGG_enrichment.R
â”‚   â”œâ”€â”€ 10_heatmap_and_featureplots.R
â”‚   â”œâ”€â”€ 11_violin_and_barplots.R
â”‚   â”œâ”€â”€ 12_volcano_plots.R
â”‚   â”œâ”€â”€ 13_combined_expression_plots.R
â”‚
â”œâ”€â”€ figures/                 # Plots generated by the R scripts
â”‚   â”œâ”€â”€ dotplots/
â”‚   â”œâ”€â”€ heatmaps/
â”‚   â”œâ”€â”€ volcano/
â”‚   â”œâ”€â”€ violin/
â”‚   â””â”€â”€ barplots/
â”‚
â”œâ”€â”€ results/                 # DEG tables, enrichment results, summary stats
â”‚   â”œâ”€â”€ differential_expression/
â”‚   â”œâ”€â”€ enrichment_GO_KEGG/
â”‚   â””â”€â”€ qc_metrics/
â”‚
â”œâ”€â”€ data/                    # Processed Seurat objects or sample data only
â”‚   â””â”€â”€ Mono_object.rds      # Not uploaded if unpublished
â”‚
â”œâ”€â”€ README.md                # Main project documentation (youâ€™re reading it)
â”œâ”€â”€ LICENSE                  # Optional: e.g. MIT or GPL-3.0
â””â”€â”€ .gitignore               # Ignore Rproj, large files, temp outputs
```
